src: http://server/testdir.tgz
checksum: f728e0ed67162aa26c25b9790380b3f7
dest: /root/app
commands:
  pre:
    - echo 'staring deploy'
    - echo `hostname`
    - curl -X DELETE http://localhost:8500/v1/kv/deploy
    - curl -X DELETE http://localhost:8500/v1/kv/deployFailure
    - curl -X PUT -d 'deploy' http://localhost:8500/v1/kv/deploy/{`hostname`}
  post:
    - echo 'deploy done'
    - 'supervisorctl restart nginx'
    - curl -X DELETE http://localhost:8500/v1/kv/deploy/{`hostname`}
  success:
    - echo 'deploy success'
  failure:
    - echo 'deploy failed!!'
    - cat >> /root/failure.log
    - curl -X PUT -d 'failure' http://localhost:8500/v1/kv/deployFailure/{`hostname`}
excludes:
  - "*.pid"
  - "*.socket"
